<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Manual Transaction Entry</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 24px; }
    form { max-width: 560px; display: grid; gap: 12px; }
    label { font-weight: 600; }
    input, select, textarea { padding: 8px; font-size: 14px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    button { padding: 10px 14px; font-weight: 600; }
    .ok { color: #0a7; }
    .err { color: #b00; }
  </style>
  <script>
    async function submitForm(e) {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());
      // Normalize
      data.amount = Number(String(data.amount).replace(/[,\s]/g, ''));
      if (!['income','expense','transfer'].includes(data.type)) {
        alert('Type must be income, expense, or transfer'); return;
      }
      const url = document.getElementById('endpoint').value.trim();
      if (!url) { alert('Missing Webhook URL'); return; }
      try {
        const res = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
        const txt = await res.text();
        document.getElementById('result').textContent = res.ok ? 'Saved: ' + txt : 'Error: ' + txt;
        document.getElementById('result').className = res.ok ? 'ok' : 'err';
        if (res.ok) e.target.reset();
      } catch (err) {
        document.getElementById('result').textContent = 'Network error: ' + err.message;
        document.getElementById('result').className = 'err';
      }
    }
  </script>
  </head>
<body>
  <h1>Manual Transaction Entry</h1>
  <p>Point this form at your n8n Webhook URL. The workflow will validate and save into Postgres.</p>
  <div class="row">
    <label>Webhook URL
      <input id="endpoint" placeholder="https://your-n8n/webhook/manual-transaction" />
    </label>
  </div>
  <form onsubmit="submitForm(event)">
    <label>Your Email (user)
      <input name="user_email" type="email" required />
    </label>
    <label>Your Name (optional)
      <input name="user_name" type="text" />
    </label>
    <div class="row">
      <label>Account Name
        <input name="account_name" placeholder="Canara Bank - XXXX250" required />
      </label>
      <label>Currency
        <input name="currency" value="INR" />
      </label>
    </div>
    <div class="row">
      <label>Amount
        <input name="amount" type="number" step="0.01" required />
      </label>
      <label>Type
        <select name="type" required>
          <option value="income">Income</option>
          <option value="expense">Expense</option>
          <option value="transfer">Transfer</option>
        </select>
      </label>
    </div>
    <label>Transaction Date
      <input name="txn_date" type="date" required />
    </label>
    <label>Category Name (optional)
      <input name="category_name" placeholder="Groceries" />
    </label>
    <label>Description (optional)
      <input name="description" placeholder="Merchant or purpose" />
    </label>
    <label>Notes (optional)
      <textarea name="notes" rows="3" placeholder="Any extra details"></textarea>
    </label>
    <button type="submit">Save Transaction</button>
  </form>
  <p id="result"></p>
</body>
</html>


